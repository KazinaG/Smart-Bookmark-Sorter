# 高レベル方針

## 目的

Smart Bookmark Sorter を「利用頻度ベースでブックマークを維持しやすくする拡張機能」として継続改善する。
開発再開フェーズでは、機能追加よりも保守可能性と変更容易性の回復を優先する。

## 対象ユーザー

- ブックマーク数が多く、手動整理の負担が高い個人ユーザー
- 定期的に同じブックマークを利用し、利用傾向に応じた並び替えを求めるユーザー

## プロダクト価値

- 利用履歴に基づく並び替えで、必要なブックマークへ短時間で到達できる
- 削除候補提示により、放置ブックマークの整理コストを下げる
- 設定変更を UI 上で完結できる

## 優先順位

1. 安全性: データ破壊や誤削除を防ぐ
2. 追跡性: 仕様・実装・テストの整合を維持する
3. 保守性: 小さな変更で機能改善できる構造へ寄せる
4. 速度: 小さな単位で継続的に出荷可能にする

## 開発スコープ（再開フェーズ）

### In Scope

- 既存機能（並び替え、削除候補、設定保存）の挙動安定化
- テスト容易性と保守性を上げるための構造整理
- Manifest v2 実装の現状把握と v3 移行準備
- jQuery 依存の段階的削減（新規依存の停止と優先箇所の置換）

### Out of Scope

- 大規模な新機能追加
- UI 全面刷新
- 複数ブラウザ対応の同時着手

## 技術方針

- 既存挙動互換を維持しつつ、段階的リファクタを行う
- ディレクトリ再編は「移動のみ」と「挙動変更」を分離する
- 開発構造（`src/extension`）と配布構造（`build/extension`）を分離し、配布要件は組み立て段で吸収する
- 共有ロジックを集約し、UI・背景処理・設定処理の責務境界を明確化する
- 新規コードでは jQuery 依存を増やさず、標準 Web API / モジュール分割を優先する

## 品質方針

- 仕様変更時は docs を先に更新する（DOCS-first）
- 変更単位ごとに Red → Green → Refactor を残す
- 反映前に最低限、対象機能の回帰確認を行う

## 意思決定ガード

- 迷った場合は「事故防止」と「追跡性」を優先する
- リリース価値に直接寄与しない変更は、小さく分割して後続へ回す
- 一度に構造を全面改修せず、段階的移行で可逆性を確保する
